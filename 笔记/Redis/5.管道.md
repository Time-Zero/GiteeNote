管道（pipeline）是为了以下问题的。
如果同时执行大量的命令，就需要等待上一条命令的执行应答后再执行，这中间不仅多了RTT（Round Time Trip），而且会频繁调用系统IO，发送网络请求。同时Redis也会频繁调用系统的`read`和`write`，在用户态和内核态之间频繁切换，对性能造成较大的影响。


而管道(pipeline)，可以<span style="color:rgb(255, 0, 0)">一次发送多条命令给服务端</span>，服务端依次处理完毕之后，通过<span style="color:rgb(255, 0, 0)">一条响应一次性将结果返回</span>，减少客户端和Redis之间的通信次数来降低往返延迟和系统开销。Pipeline的底层原理是<span style="color:rgb(255, 0, 0)">队列</span>，先进先出的特性来保持数据的顺序性
![[Pasted image 20240707162623.png]]

管道实际就是一个批处理命令

# 启用管道
在Linux下的shell环境中，将你要执行的命令放入一个文本文件，例如cmd.txt
``` shell
cat cmd.txt | redis-cli -a 密码 --pipe
```
这样就会批处理文本文件中的命令

# 注意事项
* 管道缓冲的指令只是会依次执行，不能保证执行过程的原子性，如果执行过程中出现异常，将会继续执行后续的命令
* 使用pipeline组装的命令不能太多，不然数据量过大客户端阻塞的时间可能过久，同时服务端此时也被迫回复一个队列答复，占用很多内存