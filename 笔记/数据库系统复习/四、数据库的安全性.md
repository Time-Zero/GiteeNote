# 4.1 数据库的安全性概述
数据库的安全性：是指保护数据库以防止非法用户的越权使用、窃取、更改或者破坏数据

* 数据库的安全性可以划分为三个层次：
	* 网络系统的安全
	* 操作系统的安全
	* 数据库管理系统的安全
## 网络系统的安全
这是数据库的第一个安全屏障。

## 操作系统安全
主要来自网络内使用的操作系统的安全。主要包括操作系统本身的缺陷，对于操作系统的安全配置、病毒的威胁三个方面

## 数据库系统面临的风险
* 操作系统的风险
* 管理风险
* 用户的风险
* 数据库管理系统内部的风险

## 安全标准
* TESEC：可信计算机系统评估准则，美国国防部
* ITSEC：信息技术安全评估准则，欧洲
* CTCPSEC：加拿大可信计算机产品评估准则，加拿大
* CC：通用准则，ISO（我国采用）

# 4.2 数据库安全性控制
* 数据库系统安全模型
![[Pasted image 20240620211916.png]]

* 数据库管理系统的安全模型
![[Pasted image 20240620212135.png]]

* 数据库安全性控制的常用方法
	* 用户标识和鉴定
	* 访问控制
	* 视图
	* 审计
	* 数据加密

## 4.2.1 用户标识与鉴别
* 用户标识：每个合法用户均被赋予一个身份标识
* 身份鉴别：鉴别用户的合法身份

**身份鉴别的方法：**
 * 静态口令鉴别
 * 动态口令鉴别
 * 生物特征鉴别
 * 智能卡鉴别

## 4.2.2 存取控制
* 访问控制机制的组成
	* 定义用户权限
	* 合法权限检查
* 常用访问控制方法
	* 自主访问控制 DAC：C2级，灵活
	* 强制访问控制 MAC：B1级，严格

## 4.2.3 自主访问控制方法DAC
* 主体和客体直接关联
* 主体的权限需要授权
* 具有授权资格的用户均可以实现授权

* 关系数据库中的存取权限：
![[Pasted image 20240620212656.png]]

## 4.2.4 授权：授予与收回
通过grant语句和revoke语句实现权限的授予和收回
* 谁可以发出grant
	* DBA，对象创建者，拥有该权限的用户
* 可以接受权限的用户
	* 一个或者多个具体的用户、public（全体用户）
* with grant option子句
* 不允许循环授权
![[Pasted image 20240621164531.png]]

### 授权
```sql
--把学生表的查询权限给指定用户
grant select on student to 用户名;

--把学生表的查询权限给所有用户
grant select on student to public;

--把修改sc表成绩的权限给予指定的用户
grant update(grade) on sc to 用户名;

--把插入student表的权限给予指定用户
grant insert on student to 用户名;
```

### 撤销授权
```sql
--撤回指定用户的对student表的插入权限
revoke insert on student from 用户名;

--将指定用户的修改sc表的成绩的权限收回
revoke update(grade) on student from 用户名;

--把对course表的查询权限对所有人收回
revoke select on course from public;

--收回指定用户的查找权限
revoke select on student from 用户名;
```

### 创建用户时授权
![[Pasted image 20240621165224.png]]

## 4.2.5 数据库角色
* 数据库角色：被命名的一组与数据库相关的权限
* 角色是权限的集合
* 可以为一组拥有相同权限的用户创建角色
* 简化授权的过程
* 怎么创建: creat role 角色名
* 给角色授权

### 角色授权
```sql
--创建名为test的角色
create role test;

--授予test角色对于student表的查询、插入、删除和修改的权限
grant select,insert,delete,update on student to test;

--把test角色授予给用户
exec sp_addrolemember 'test','用户名';

--删除用户
drop user 用户名;

--删除角色
drop role test;

--删除登录名
drop login 登录名;
```


授予角色的命令可以记为:
add role member

## 4.2.6 强制存取控制MAC
* 更高程度的安全性
* 用户不能直接感知或者进行控制
* 适用于对于数据有着严格而固定密级分类的部门

### 主体
主题是系统中活动的实体，也就是
* DBMS所管理的实际的用户
* 代表用户的各个进程

### 客体
客体是系统中的被动实体，是受到主题操纵的
* 文件、基本表、索引、视图

### 敏感度标记
* 主体的敏感度标记称为许可证级别
* 客体的敏感度标记被称为密级

### 强制存取控制规则
1. 只有当主体的许可证级别大于或者等于客体的密级时，该主体才能够读取相应的客体
2. 只有当主体的许可证级别等于客体的密级时，该主体才能写对应的客体

下面这个有点冲突了？？？？
**修正规则：** 主体的许可证级别 <= 客体的密级时，主体才能写客体


# 4.3 视图机制
* 把要保密的数据对无权存取这些数据的用户隐藏起来，对数据提供一定程度的安全保护
* 视图的主要功能是提供数据独立性，无法完全满足要求
* 视图间接实现了支持存取谓词的用户权限定义

是因为视图在表的基础上再做了划分？？？
```sql
--基于student表中的所有计算机科学专业的学生创建视图
create view v_student as select * from student where sdept='cs';

--授予查找权限
grant select on v_student to 张三;

--授予全部权限
grant all priviliges on v_student to 李四;
```

# 4.4 审计
* 审计日志：将用户对于数据的所有操作都记录在上面
* DBA利用审计日志